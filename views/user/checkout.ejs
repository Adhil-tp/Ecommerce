<%- include('partials/header') %>


<div class="message hello">
    <p class="message-status strong">Status</p>
    <p class="message-message">Message</p>
</div>
    <div class="checkout-section">
        <div class="container">
            <!-- <div class="row">
                <div class="col-12">
                    <div class="user-actions accordion">
                        <h3>
                            <i class="fa fa-file-o" aria-hidden="true"></i>
                            Returning customer?
                            <a class="Returning" href="#" aria-expanded="true">Click here to login</a>
                        </h3>
                        <div id="checkout_login" class="collapse">
                            <div class="checkout_info">
                                <p>If you have shopped with us before, please enter your details in the boxes below. If
                                    you are a new customer please proceed to the Billing &amp; Shipping section.</p>
                                <form action="#">
                                    <div class="form_group default-form-box">
                                        <label>Username or email <span>*</span></label>
                                        <input type="text">
                                    </div>
                                    <div class="form_group default-form-box">
                                        <label>Password <span>*</span></label>
                                        <input type="password">
                                    </div>
                                    <div class="form_group group_3 default-form-box">
                                        <button class="btn btn-md btn-black-default-hover" type="submit">Login</button>
                                        <label class="checkbox-default">
                                            <input type="checkbox">
                                            <span>Remember me</span>
                                        </label>
                                    </div>
                                    <a href="#">Lost your password?</a>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="user-actions accordion">
                        <h3>
                            <i class="fa fa-file-o" aria-hidden="true"></i>
                            Returning customer?
                            <a class="Returning" href="#">Click here to enter your code</a>

                        </h3>
                        <div id="checkout_coupon" class="collapse checkout_coupon">
                            <div class="checkout_info">
                                <form action="#">
                                    <input placeholder="Coupon code" type="text">
                                    <button class="btn btn-md btn-black-default-hover" type="submit">Apply
                                        coupon</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
            <!-- Start User Details Checkout Form -->
            <div class="checkout_form">
                
                <div class="row ">
                    <div class="col-lg-6 col-md-6 d-flex flex-column gap-30">
                        <div class="coupon_code left">
                            <h3>Coupon</h3>
                            <div class="coupon_inner">
                                <% if(userCoupons ){ %>
                                    <% userCoupons.forEach(coupon => { %>
                                    <div class="available-coupons">
                                        <div class="coupon d-flex justify-content-around">
                                            <div class="coupon-child">
                                                <h2><%= coupon.description %></h2>
                                                <p>Promo code : <%= coupon.code %></p>
                                            </div>
                                            <div class="coupon-child">
                                                <h2><span class="discount-percentage"><%= coupon.discount %>%</span><sup>OFF</sup></h2>
                                                <button value="<%= coupon._id %>" class="promo-code btn btn-golden">Use</button>
                                            </div>
                                        </div>
                                    </div>
                                    <% }) %>
                                <% }else { %>
                                    <div class="available-coupons">
                                        <div class="coupon d-flex justify-content-around">
                                            <div class="coupon-child">
                                                <h2>No coupons found</h2>
                                            </div>
                                        </div>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                        <section>
                            <h3>Choose address</h3>
                            <% if(addresses ){ %>
                                <div class="addresses">
                                <% addresses.forEach(address=> { %>
                                    <div class="col-lg-12 d-flex address address-<%= address._id %>">
                                        <div class="d-flex justify-content-start relative input-parent">  
                                            <input type="radio" name="address" class="address-input" value="<%= address._id %>">
                                        </div>
                                        <div class="address-details">
                                            <% if(address.default){ %>
                                                <p style="font-weight: bolder;">Default address</p>
                                                <% }%>
                                            <p><%= address.firstName %></p>
                                            <p><%= `${address.houseAndStreet},${address.postOffice}(PO),${address.district}` %></p>
                                            <p><%=`${address.district},${address.state}-${address.pin}` %></p>
                                            <p>Mobile : <%= address.phone %></p>
                                            <div class="address-options">
                                                <button href="">Edit</button>
                                                <button class="remove-address" value="<%= address._id %>">Remove</button>
                                            </div>
                                        </div>
                                    </div>
                                    <% }) %>
                                </div>
                                        <div class="order_button pt-3 col-12">
                                            <button class="btn btn-md btn-black-default-hover col-12 add-new-address"
                                                type="button">Add address</button>
                                        </div>
                                        <% } %>
                                            <form class="row address-form">
                                                <div class="col-lg-6">
                                                    <div class="default-form-box">
                                                        <label for="first-name">First Name <span>*</span></label>
                                                        <input type="text" id="first-name" name="firstName">
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="default-form-box">
                                                        <label for="last-name">Last Name <span>*</span></label>
                                                        <input type="text" id="last-name" name="lastName">
                                                    </div>
                                                </div>
                                                <!-- <div class="col-12">
                                        <div class="default-form-box">
                                            <label>Company Name</label>
                                            <input type="text">
                                        </div>
                                    </div> -->
                                                <div class="col-6">
                                                    <div class="default-form-box">
                                                        <label>Pin<span>*</span></label>
                                                        <input type="text" name="pin" placeholder="Pin number">
                                                    </div>
                                                </div>

                                                <div class="col-6">
                                                    <div class="default-form-box">
                                                        <label>Post office<span>*</span></label>
                                                        <select name="postOffice" id="post-office" class="col-12">
                                                            <!-- <option >nme</option> -->
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="default-form-box">
                                                        <label>District<span>*</span></label>
                                                        <input placeholder="District" type="text" name="district"
                                                            disabled>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="default-form-box">
                                                        <label>State <span>*</span></label>
                                                        <input type="text" name="state" placeholder="State" disabled>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="default-form-box">
                                                        <label>Street address <span>*</span></label>
                                                        <input placeholder="House number and street name" type="text"
                                                            name="houseAndStreet">
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="default-form-box">
                                                        <label>Town / City <span>*</span></label>
                                                        <input type="text" name="city" placeholder="Town / city">
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="default-form-box">
                                                        <label>Phone<span>*</span></label>
                                                        <input type="text" name="phone" placeholder="Phone number">
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="default-form-box">
                                                        <label> Email Address <span>*</span></label>
                                                        <input type="text" name="email" placeholder="Email address">
                                                    </div>
                                                </div>

                                                <!-- <div class="col-12 mt-3">
                                        <div class="order-notes">
                                            <label for="order_note">Order Notes</label>
                                            <textarea id="order_note"
                                                placeholder="Notes about your order, e.g. special notes for delivery." name="orderNote"></textarea>
                                        </div>
                                    </div> -->
                                                <div class="order_button pt-3 col-12">
                                                    <button
                                                        class="btn btn-md btn-black-default-hover col-12 add-address"
                                                        type="submit">Save address</button>
                                                </div>
                                            </form>

                        </form>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <form>
                            <h3>Your order</h3>
                            <div class="order_table table-responsive">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Product</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% if (products) { %>
                                            <% products.forEach(product=> { %>
                                                <tr>
                                                    <td>
                                                        <%= product.name %><strong> × <%= product.cartQuantity %>
                                                            </strong>
                                                    </td>
                                                    <td> ₹<%= (product.offerPrice ? product.offerPrice : product.price)
                                                            * product.cartQuantity %>
                                                    </td>
                                                </tr>
                                                <% }) %>
                                                    <% } %>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th>Cart Subtotal</th>
                                            <% let sum=0 %>
                                                <% for( let index=0; index < products.length; index++ ) { %>
                                                    <% sum +=(products[index].offerPrice ? products[index].offerPrice
                                                        : products[index].price) * products[index].cartQuantity %>
                                                        <% } %>
                                                            <td>₹<%= sum %>
                                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Shipping</th>
                                            <td><strong>
                                                    <%= sum > 500 ? 'FREE SHIPPING' : '₹50' %>
                                                </strong></td>
                                        </tr>
                                        <tr class="order_total">
                                            <th>Order Total</th>
                                            <td><strong  class="order-total">₹<%= sum > 500 ?  sum : sum + 50%></strong></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            <div class="payment_method">
                                <div class="panel-default">
                                    <label class="checkbox-default" for="currencyCod" dat-bs-toggle="collapse"
                                        dat-bs-target="#methodCod">
                                        <input type="checkbox" id="currencyCod">
                                        <span>Cash on Delivery</span>
                                    </label>


                                </div>

                                <div class="order_button pt-3">
                                    <button class="btn btn-md btn-black-default-hover proceed-payment col-12 " 
                                        type="button">Proceed to payment </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div> <!-- Start User Details Checkout Form -->
        </div>
    </div><!-- ...:::: End Checkout Section:::... -->

    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>


    <%- include('partials/footer') %>